
@{
    Layout = "~/Views/Shared/_LayoutMainMetronic.cshtml";
}

<script type="text/javascript">
    function Edit() {
        var keys = $("#grid1").dxDataGrid("getSelectedRowKeys");
        if (keys.length >= 1) {
            window.location = "@Url.Action("Edit","Penarikan_Data")/" + keys[0].toString();
        } else {
           swal({type: 'error', title: 'Oops...', text: 'Silahkan Pilih Baris Telebih Dahulu'});
        }
    }
    function Delete() {
        var keys = $("#grid1").dxDataGrid("getSelectedRowKeys");
        if (keys.length >= 1) {
            var ask = confirm('Apakah Anda yakin akan menghapus data ini ?');
            if (ask) {
                $.ajax({
					type: "POST",
					url: "@Url.Action("Delete", "Penarikan_Data")",
                    contentType: "application/x-www-form-urlencoded;charset=UTF-8",
                    dataType: "json",
                    data: "param1=" + keys[0].toString(),
                    success: function (response) {
                        alert(response);
                        $("#grid1").dxDataGrid("refresh");
                    },
                    error: function (response) {
                        swal({type: 'error', title: 'Oops...', text: response.responseJSON.error});
                    }
				});
            }
        } else {
            swal({type: 'error', title: 'Oops...', text: 'Silahkan Pilih Baris Telebih Dahulu'});
        }
    }

</script>
@section RightToolbar{
    <div class="d-flex align-items-center">
        <!--begin::Actions-->
        @{
            if (ViewBag.Add)
            {
                <a class="btn btn-light-primary font-weight-bolder btn-sm mr-2" href="@Url.Action("Create", "Penarikan_Data")"><span class="image fa fa-plus"></span> Tambah</a>
            }
            if (ViewBag.Edit)
            {
                <a class="btn btn-light-primary font-weight-bolder btn-sm mr-2" href="javascript:Edit();"><span class="image fa fa-edit"></span> Ubah</a>
            }
            if (ViewBag.Delete)
            {
                <a class="btn btn-light-primary font-weight-bolder btn-sm mr-2" href="javascript:Delete();"><span class="image fa fa-edit"></span> Hapus</a>
            }
        }
        <!--end::Actions-->
    </div>
}
<div class="card card-default">
    <div class="gridview-div">
        @Html.AntiForgeryToken()

        @(Html.DevExtreme().DataGrid()
            .ID("grid1")
            .DataSource(d => d.Mvc()
                .Controller("Penarikan_Data")
                .LoadAction("GetGridData")
                .Key("mpd_id")
            )
            .RemoteOperations(true)
            .Width("100%")
            .Columns(columns =>
            {

                columns.Add().DataField("mpd_periode").Caption("Periode").Width("35%").DataType(GridColumnDataType.DateTime).Format("yyyy-MM");
                columns.Add().DataField("mpd_jenis").Caption("Jenis").Width("35%");
                columns.Add().DataField("mpd_status").Caption("Status").Width("30%");

            })
            .FilterRow(f => f.Visible(true))
            .ShowBorders(false)
            .Selection(c => c.Mode(SelectionMode.Single))
            .RowAlternationEnabled(false)
            .Paging(p =>
            {
                p.PageSize(20);
                p.Enabled(true);
            }
            )
             .Pager(p =>
                {
                p.ShowInfo(true);
                }
             )
        )

    </div>
</div>


